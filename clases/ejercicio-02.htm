<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Ejercicios con Clases en Javascript Ejercicio 2</title>
    <link rel="stylesheet" href="css/styles.css" />
  </head>
  <body>
    <div class="container">
      <header>
        <a href="../clases.html" class="btn-volver">‚Üê Volver al √≠ndice</a>

        <h1>Ejercicio 2 Auto</h1>
        <p>
          Crear las siguientes clases con sus respectivos m√©todos y propiedades.
          Usar propiedades privadas. Cuando se devuelvan valores, si son objetos
          y arrays de las propiedades, devolver copias de los mismo, para evitar
          que puedan ser modificados.
        </p>
        <p style="color: var(--secondary-color); margin-top: 0.5rem">
          - **Propiedades** <br />
          - `encendido` (booleano), inicializa en `false` <br />
          - `velocidad` (n√∫mero), inicializa en 0 <br />
          - `marca` (string) <br />
          - `modelo` (n√∫mero) <br />
          - `patente` (string) <br />
          - **Constructor** <br />
          - pide como argumentos `marca`, `modelo`, `patente` y los asigna a sus
          respectivas propiedades <br />
          - **M√©todos** <br />
          - **`arrancar()`** pone `encendido` en `true` <br />
          - **`apagar()`** pone `encendido` en `false` <br />
          - **`acelerar()`** suma 10 a `velocidad` y actualiza dicha propiedad
          <br />
          - **`desacelerar()`** resta 10 a `velocidad` y actualiza dicha
          propiedad <br />
          - **`toString()`** devuelve un *string* con la siguiente plantilla
          `${marca} ${modelo}, patente ${patente}` <br />
          - **Observaciones** <br />
          - s√≥lo se puede acelerar o desacelerar si el auto se encuentra
          prendido <br />
          - s√≥lo se puede apagar el auto si la velocidad es 0 <br />
          - la velocidad m√≠nima es 0
        </p>
      </header>

      <main>
        <button type="button" class="btn-refresh" onclick="location.reload()">
          <span class="icon">‚Üª</span> Actualizar P√°gina
        </button>
      </main>
    </div>
    <script src="./js/script.js"></script>
    <script>
      class Auto {
        // Propiedades privadas
        #encendido = false;
        #velocidad = 0;
        #marca;
        #modelo;
        #patente;

        constructor(marca, modelo, patente) {
          this.#marca = marca;
          this.#modelo = modelo;
          this.#patente = patente;
        }

        arrancar() {
          this.#encendido = true;
          alert("üöÄ El auto ha arrancado.");
        }

        apagar() {
          if (this.#velocidad > 0) {
            throw new Error(
              "No puedes apagar el auto mientras est√° en movimiento. ¬°Frena primero!"
            );
          }
          this.#encendido = false;
          alert("üí§ El auto se ha apagado.");
        }

        acelerar() {
          if (!this.#encendido) {
            throw new Error("El auto est√° apagado. No puedes acelerar.");
          }
          this.#velocidad += 10;
          alert(`Acelerando... Velocidad actual: ${this.#velocidad} km/h`);
        }

        desacelerar() {
          if (!this.#encendido) {
            throw new Error("El auto est√° apagado.");
          }

          // La velocidad m√≠nima es 0
          if (this.#velocidad <= 0) {
            this.#velocidad = 0;
            alert("El auto ya est√° detenido.");
          } else {
            this.#velocidad -= 10;
            alert(`Desacelerando... Velocidad actual: ${this.#velocidad} km/h`);
          }
        }

        obtenerDatos() {
          // Devolvemos una copia de los datos (aunque son strings/numbers y ya se copian por valor)
          return {
            marca: this.#marca,
            modelo: this.#modelo,
            patente: this.#patente,
            velocidad: this.#velocidad,
            encendido: this.#encendido,
          };
        }

        toString() {
          return `${this.#marca} ${this.#modelo}, patente ${this.#patente}`;
        }
      }

      // --- Interacci√≥n con el usuario ---

      // 1. Pedimos datos iniciales
      const marca = prompt("Introduce la marca del auto:");
      const modelo = prompt("Introduce el modelo (a√±o):");
      const patente = prompt("Introduce la patente (matr√≠cula):");

      const miAuto = new Auto(marca, modelo, patente);
      console.log("Auto creado:", miAuto.toString());

      let continuar = true;

      while (continuar) {
        const datos = miAuto.obtenerDatos();
        const estado = datos.encendido ? "ENCENDIDO" : "APAGADO";

        const opcion = prompt(
          `Veh√≠culo: ${miAuto.toString()}\n` +
            `Estado: ${estado} | Velocidad: ${datos.velocidad} km/h\n\n` +
            `¬øQu√© quieres hacer?\n` +
            `1. Arrancar\n2. Acelerar\n3. Desacelerar\n4. Apagar\n5. Salir`
        );

        try {
          switch (opcion) {
            case "1":
              miAuto.arrancar();
              break;
            case "2":
              miAuto.acelerar();
              break;
            case "3":
              miAuto.desacelerar();
              break;
            case "4":
              miAuto.apagar();
              break;
            case "5":
            case null:
              continuar = false;
              alert("Saliendo del simulador...");
              break;
            default:
              alert("Opci√≥n no v√°lida.");
          }
        } catch (error) {
          alert("‚ö†Ô∏è " + error.message);
        }
      }
    </script>
  </body>
</html>
